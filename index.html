<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/atom-one-dark.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <title>Crud Generator</title>

    <style>
        .hidden {
            display: none;
        }
    </style>
    
  </head>
  <body>
   

    <div class="container mt-5">
        <center>
        </center>
        <div class="row">

            <div class="col-md-1">
                <img src="a.jpg" alt="" srcset="" width="100px">
            </div>

            <div class="col-md-5">
                <div style="margin-top: 43px;">
                    <h5 ><b> Crud Generator</b></h5>
                    <p> <i> REST API Node.js, Express, And MySQL</i></p>
                </div>
            </div>

        </div>
       
      
        <div class="row mt-2">
            <div class="col-md-4">
                <a onclick="tes()" type="button" class="btn btn-sm btn-danger" >Test Template Admin <i class="fa-solid fa-rotate-right" ></i> </a>
                
                <div style="height: 450px;" class="card">
                    <div class="card-body">
                        <p style="font-weight: bold;" >Project</p>
                        <a  type="button" class="btn btn-sm btn-success" data-bs-toggle="modal" data-bs-target="#settingModal" >Setting <i class="fa-solid fa-gear" ></i> </a>
                        <a onclick="reset()" type="button" class="btn btn-sm btn-danger" >Reset Project <i class="fa-solid fa-rotate-right" ></i> </a>
                        <hr>
                        <p>
                           Project Name  : <span id="textProjectName" ></span>  <br>
                           Port : <span id="textPort" ></span> <br>
                        </p>
                        <hr>
                        <p>
                          <span style="font-size: 11px;" ><i>Database Info</i></span>   <br>
                            Host : <span id="textHost" ></span> <br>
                            User : <span id="textUser" ></span> <br>
                            Password : <span id="textPassword" ></span> <br>
                            Database : <span id="textDatabase" ></span> <br>
                        </p>
                        <hr>
                        <a onclick="showCodeProject()"  type="button" class="btn btn-sm btn-secondary mt-2" >Show Project Code <i class="fa-solid fa-magnifying-glass" ></i> </a>

                        <a  type="button" class="btn btn-sm btn-secondary mt-2" onclick="downloadProject()" >Download Project  <i class="fa-solid fa-book" ></i> </a>
                        
                        <!-- <a  type="button" class="btn btn-sm btn-secondary mt-2" onclick="$('#adminPageList').modal('show')" >Admin Page  <i class="fa-solid fa-book" ></i> </a> -->

                    </div>
                  </div>

              
            </div>
            <div class="col-md-4">
              
                <div style="height: 450px;" class="card">
                    <div class="card-body">
                      
                        <!-- button untuk tambah table -->
                        <p style="font-weight: bold;" >  List Tables</p>
                        <a  type="button" class="btn btn-sm btn-success" data-bs-toggle="modal" data-bs-target="#tambahTable" >Add Table <i class="fa-solid fa-plus" ></i></a>
                        <a  type="button" class="btn btn-sm btn-success" data-bs-toggle="modal" data-bs-target="#authModal" >Add Auth Table <i class="fa-solid fa-key" ></i></a>
                        <hr>
                        <ul class="list-group" id="listTables">
                        <!-- List Table yang di simpan -->
                     
                           
                           
                        </ul>

                    </div>
                  </div>

              
            </div>
            <div class="col-md-4 hidden" id="tableDetail"  >

                <div class="card ">
                    <div style="height: 450px;" class="card-body ">
                        <!-- table -->
                        <p style="font-weight: bold;" >Detail <span id="titleTable"></span> Table</p>
                        <table class="table table-hover text-center">
                            <thead>
                              <tr>
                                <th scope="col">No</th>
                                <th scope="col">Field</th>
                              
                               
                              </tr>
                            </thead>
                            <tbody id="listFieldTables">
                             
                            </tbody>
                          </table>
                          <!-- end table -->

                          <hr>
                          <!-- download -->
                          <!-- data akan diexport menjadi .js -->
                          <!-- end download -->
                          
                        </div>
                    </div>
         
                    

            </div>
        
        </div>
        <!-- code editor menampung index.js, package.json , database.js  -->
        <div id="codeEditorProject" class="row mt-3 hidden justify-content-center" >

            <div class="col-md-6">
                <hr>
                <label for="exportedController"> project/config/database.js </label> 
                <div id ="exportedDatabase" >

                </div>

            </div>

            <div class="col-md-6">
                <hr>
                <label for="exportedController"> project/index.js </label> 
                <div id ="exportedIndex" style="height: 400px;overflow: auto;">

                </div>
              
            </div>
           
            <div class="col-md-6">
                <hr>
                <label for="exportedController"> project/package.json </label> 
                <div id ="exportedPackage" style="height: 400px;overflow: auto;">

                </div>

            </div>
            <div class="col-md-6">
                <hr>
                <label for="exportedAuthTable"> controller/login.js </label> 
                <div id ="exportedAuthTable" style="height: 400px;overflow: auto;">

                </div>

            </div>
           
           

        </div>


        <hr>
        
        <!-- Code editor menampung code model dan controller -->
        <div id="codeEditor" class="row mt-3 hidden">

            <div class="col-md-6">
                <label for="exportedController">Controller Files : <span id="namaController"></span> </label> 
                <br>
                
                <div class="mt-2 mb-2">
                    <a onclick="copyController()" class="btn btn-sm btn-secondary me-1"> Copy <i class="fa-regular fa-copy" ></i> </a>
                    <a onclick="downloadController()" class="btn btn-sm btn-secondary me-1"> Download <i class="fa-regular fa-file" ></i> </a>
                </div>



                <div id="exportedController">


                </div>
            </div>

            <div class="col-md-6">


                <label for="exportedModel">Model Files : <span id="namaModel"></span> </label> 
                <br>

                <div class="mt-2 mb-2">
                    <a onclick="copyModel()" class="btn btn-sm btn-secondary me-1"> Copy <i class="fa-regular fa-copy" ></i> </a>
                    <a onclick="downloadModel()" class="btn btn-sm btn-secondary me-1"> Download <i class="fa-regular fa-file" ></i> </a>
                </div>

                <div id="exportedModel">


                </div>
            </div>

        </div>

    </div>

 <!-- Modal setting Project -->

  <!-- Modal -->
  <div class="modal fade" id="settingModal" tabindex="-1" aria-labelledby="settingModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title fs-5" id="settingModalLabel">Setting Project</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">

            <div class="mb-3">
                <label for="namaProject" class="form-label">Nama Project</label>
                <input type="text" class="form-control" id="namaProject" placeholder="Masukan Project">
            </div>
            <div class="mb-3">
                <label for="portProject" class="form-label">Port</label>
                <input type="number" class="form-control" id="portProject" placeholder="Port server">
            </div>

            <hr>
            <p> <i>Database info </i> </p>

            <div class="mb-3">
                <label for="hostDatabase" class="form-label">Host</label>
                <input type="text" class="form-control" id="hostDatabase" placeholder="Host">
            </div>

            <div class="mb-3">
                <label for="userDatabase" class="form-label">User</label>
                <input type="text" class="form-control" id="userDatabase" placeholder="user database">
            </div>

            <div class="mb-3">
                <label for="passwordDatabase" class="form-label">password</label>
                <input type="text" class="form-control" id="passwordDatabase" placeholder="password database">
            </div>

            <div class="mb-3">
                <label for="namaDatabase" class="form-label">Database</label>
                <input type="text" class="form-control" id="namaDatabase" placeholder="nama database">
            </div>

            
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button onclick="saveSetting()" type="button" class="btn btn-primary">Save</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="authModal" tabindex="-1" aria-labelledby="authModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title fs-5" id="authModalLabel">Authentication User</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">

            <div class="mb-3">
                <label for="namaTableAuth" class="form-label">Nama Table Auth</label>
                <input type="text" class="form-control" id="namaTableAuth" placeholder="Masukan Project">
            </div>
            <div class="mb-3">
                <label for="portProject" class="form-label">Masukan Jumlah Field</label>
                <input type="number" class="form-control" id="authField" placeholder="jumlah">
            </div>

            <a onclick="nextAuth()" class="btn btn-sm btn-secondary me-1" onclick="">Next</a>

            <hr>

            <div class="mt-1 " id="fieldAuth">


            </div>
       
            
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button onclick="saveAuthTable()" type="button" class="btn btn-primary">Save</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal tambah Modal-->
  <div class="modal fade" id="tambahTable" tabindex="-1" aria-labelledby="tambahTableLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="tambahTableLabel">Tambah Table</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            
            <div class="mb-3">
                <label for="namaTable" class="form-label">Nama Table</label>
                <input type="text" class="form-control" id="namaTable" placeholder="Masukan Nama Table">
            </div>

            <div class="mb-3">
                <label for="jumlahRow" class="form-label">Jumlah Row Table</label>
                <input type="number" class="form-control" id="jumlahRow" placeholder="Masukan Jumlah Row">
            </div>
            
            <button onclick="next()" type="button" class="btn btn-primary">Next</button>
            
            <hr>
            <!-- Jika Pencet Next maka dibawah akan keluar inputan sesuai jumlah row yang di isi -->
            <div class="hidden" id="field">
        
                <p> <b> Field Table</b></p>
                <div class="mb-3">
                    <label for="fieldPrimary" class="form-label">Field Primary</label>
                    <input type="text" class="form-control" id="fieldPrimary" placeholder="Masukan Nama Field Primary ">
                </div>

         
            </div>

            
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" onclick="save()" class="btn btn-primary">Simpan</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- modal list admin page -->
  <div class="modal fade" id="adminPageList" tabindex="-1" aria-labelledby="adminPageListLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title fs-5" id="adminPageListLabel">List Template Admin Page</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <div class="row justify-content-between">
                <div class="col-3">
                    <!-- Default dropend button -->
                    <div class="row mt-2">
                        <div class="btn-group dropend mt-2">
                            <button type="button" class="btn btn-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                            React JS | 
                            </button>
                            <ul class="dropdown-menu">
                            <!-- Dropdown menu links -->
                                <li><span style="margin-left: 12px;">Version</span> </li>
                                <hr class="dropdown-divider"> 
                                <li><a class="dropdown-item" href="#">React.JS 18.2.0 | Admin Kit</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="btn-group dropend mt-2">
                            <button type="button" disabled class="btn btn-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                            Next JS
                            </button>
                            <ul class="dropdown-menu">
                            <!-- Dropdown menu links -->
                                <li><span class="ms-5">Version</span> </li>
                                <hr class="dropdown-divider"> 
                                <li><a class="dropdown-item" href="#"> 18.2.0</a></li>
                            </ul>
                        </div>
                    </div>
  
                </div>
                <div class="col-7">
                    <!-- Default dropend button -->
                    <img width="100%" src="/img/adminkit.jpg" alt="" srcset="">
                    <a class="btn btn-primary mt-1">Download</a>
                </div>
            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

    <script src="https://code.jquery.com/jquery-3.7.1.slim.js" integrity="sha256-UgvvN8vBkgO0luPSUl2s8TIlOSYRoGFAX4jlCIm9Adc=" crossorigin="anonymous"></script> 

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>


    <script>hljs.highlightAll();</script>


    <script src="expressTemplate/controllerTemplate.JS"></script>
    <script src="expressTemplate/modalTemplate.JS"></script>
    <script src="expressTemplate/projectTemplate.js"></script>
    <script src="expressTemplate/authenticationTemplate.js"></script>

    <!-- template Admin -->
    <script src="adminPage/reactJS/18.2/view_baru.js"></script>

    <script src="main.js"></script>
    <script src="download.js" ></script>


    <script>
        function reset() {
            // delete all localStorage and reload page
            localStorage.clear();
            window.location.reload();
        }

        function tes() {
            var code = viewAdmin();
         
            // Create a Blob containing the code
            var blob = new Blob([code], { type: "text/javascript" });

            // Create a link element to trigger the download
            var link = document.createElement("a");
            link.download = 'view.js';
            link.href = window.URL.createObjectURL(blob);
            link.click();

        }

        function nextAuth() {
            
            var jumlahField = $("#authField").val();

            let htmlfield = ``;
            for (let i = 0; i < jumlahField; i++) {
                
                htmlfield += `<div class="mb-3">
                    <label for="exampleFormControlInput1" class="form-label">Field ${i+1}</label>
                    <input type="text" class="form-control" id="authField${i+1}" placeholder="Masukan Nama Field ${i+1}">
                </div>`
                
            }

            $("#fieldAuth").html(htmlfield);
            
        }

        function saveAuthTable() {

            var jumlahField = $("#authField").val();
            var namaTable = $("#namaTableAuth").val();


            var isiField = [];

            for (let i = 0; i < jumlahField; i++) {
                var getfield = $('#authField'+(i+1)).val();
                isiField.push(getfield);
            }

            console.log(isiField);
        

                var configAuth = {
                "auth": {
                    "field": isiField,
                    "table": namaTable
                },
                
            }

            localStorage.setItem("configAuth", JSON.stringify(configAuth));
            getDataLocal();
                
        }



    </script>
    

</body>
</html>
